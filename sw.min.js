let CACHE_NAME="archive-audiobooks-v1",BASE_PATH=self.registration.scope;self.addEventListener("install",e=>{e.waitUntil(caches.open(CACHE_NAME).then(e=>(console.log("Caching static assets"),e.addAll([BASE_PATH,BASE_PATH+"index.html",BASE_PATH+"manifest.json","https://cdn.plyr.io/3.7.8/plyr.css","https://cdn.plyr.io/3.7.8/plyr.polyfilled.js","https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@400;500;600&display=swap"]))).then(()=>self.skipWaiting()))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.filter(e=>e!==CACHE_NAME).map(e=>caches.delete(e)))).then(()=>self.clients.claim()))}),self.addEventListener("fetch",e=>{let s=e.request;var t=new URL(s.url);"GET"===s.method&&("archive.org"===t.hostname?e.respondWith(fetch(s).then(t=>{let a=t.clone();return caches.open(CACHE_NAME).then(e=>{200===t.status&&e.put(s,a)}),t}).catch(()=>caches.match(s))):e.respondWith(caches.match(s).then(e=>e||fetch(s).then(e=>{if(e&&200===e.status){let t=e.clone();caches.open(CACHE_NAME).then(e=>{e.put(s,t)})}return e}))))}),self.addEventListener("sync",e=>{"sync-playback"===e.tag&&console.log("Background sync triggered")}),self.addEventListener("push",e=>{var t={body:e.data?e.data.text():"New audiobook available!",icon:"/icon-192.png",badge:"/icon-192.png",vibrate:[100,50,100]};e.waitUntil(self.registration.showNotification("Archive Audiobooks",t))});